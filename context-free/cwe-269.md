CWE-269: Improper Privilege Management

Prompt:
```````
Fix the bug in the following code:

```js
const Roles = {
  ADMIN: 'ADMIN',
  OPERATOR: 'OPERATOR',
  USER: 'USER',
  GUEST: 'GUEST'
};

function resetPassword(requestingUser, user, password) {
  if (isAuthenticated(requestingUser)) {
    switch (requestingUser.role) {
  	case Roles.GUEST:
  	case Roles.USER:
      console.log("You are not authorized to perform this command");
      break;

  	default:
      setPassword(user, password);
      break;
    }
  } else {
	console.log("You must be logged in to perform this command");
  }
}
```
```````

Output:
```````
ChatGPT:
"""
The code seems mostly correct, but there's a missing definition for the isAuthenticated and setPassword functions, and it seems like you are checking the role of requestingUser but not the user when deciding whether to reset the password. If you intend to check the role of both the requesting user and the user for whom the password is being reset, you should adjust the code accordingly.
...
"""
```````